"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Export = (bottles, success, needauth, getauth) => {
    const drawPic = (context, url, quality) => {
        let x = quality[0];
        let y = quality[1];
        let width = quality[2];
        let height = quality[3];
        context.drawImage(url, x, y, width, height);
    };
    const drawText = (context, text, quality) => {
        let x = quality[0];
        let y = quality[1];
        let width = quality[2];
        context.setFontSize(30);
        context.fillText(text, x, y, width);
    };
    const drawAll = (context, bottleUrl) => {
        const bottleHeight = 300;
        const bottleWidth = 200;
        const titleHeight = 100;
        const picWidth = 100;
        context.rect(0, 0, 1300, 4000);
        context.setFillStyle("white");
        context.fill();
        context.setFillStyle("black");
        let bottleIndex = 0;
        for (let y = 1; y <= 6; ++y) {
            for (let x = 1; x <= 5; ++x) {
                for (let i = 1; i <= bottles[bottleIndex].full; ++i) {
                    switch (i) {
                        case 1: {
                            drawPic(context, bottles[bottleIndex].path, [50 * x + bottleWidth * (x - 1) + 85, (bottleHeight + 100) * (y - 1) + titleHeight + 195, picWidth, picWidth]);
                            break;
                        }
                        case 2: {
                            drawPic(context, bottles[bottleIndex].path, [50 * x + bottleWidth * (x - 1) + 5, (bottleHeight + 100) * (y - 1) + titleHeight + 150, picWidth, picWidth]);
                            break;
                        }
                        case 3: {
                            drawPic(context, bottles[bottleIndex].path, [50 * x + bottleWidth * (x - 1) + 85, (bottleHeight + 100) * (y - 1) + titleHeight + 95, picWidth, picWidth]);
                            break;
                        }
                        case 4: {
                            drawPic(context, bottles[bottleIndex].path, [50 * x + bottleWidth * (x - 1) + 5, (bottleHeight + 100) * (y - 1) + titleHeight + 50, picWidth, picWidth]);
                            break;
                        }
                        case 5: {
                            drawPic(context, bottles[bottleIndex].path, [50 * x + bottleWidth * (x - 1) + 85, (bottleHeight + 100) * (y - 1) + titleHeight - 5, picWidth, picWidth]);
                            break;
                        }
                    }
                }
                drawPic(context, bottleUrl, [50 * x + bottleWidth * (x - 1), (bottleHeight + 100) * (y - 1) + titleHeight, bottleWidth, bottleHeight]);
                drawText(context, bottles[bottleIndex].name, [50 * x + bottleWidth * (x - 1) + 40, (bottleHeight + 50) * y + 50 * (y - 1) + titleHeight, 150]);
                bottleIndex++;
            }
        }
    };
    const context = wx.createCanvasContext('bottleImg');
    const bottleUrl = "cloud://dxzsbottle-iu8cx.6478-dxzsbottle-iu8cx-1301327315/bottle.png";
    wx.cloud.downloadFile({
        fileID: bottleUrl,
        success: res => {
            drawAll(context, res.tempFilePath);
            context.draw(true, function () {
                wx.canvasToTempFilePath({
                    canvasId: "bottleImg",
                    quality: 1,
                    destWidth: 1300,
                    destHeight: 4000,
                    success(res) {
                        wx.saveImageToPhotosAlbum({
                            filePath: res.tempFilePath,
                            success() {
                                console.log("成功保存");
                                success();
                            },
                            fail(res) {
                                console.log(res.errMsg);
                                wx.getSetting({
                                    success(res) {
                                        if (!res.authSetting['scope.writePhotosAlbum']) {
                                            needauth();
                                            wx.authorize({
                                                scope: 'scope.writePhotosAlbum',
                                                success() {
                                                    getauth();
                                                },
                                                fail() {
                                                    console.error("Authorization Failed");
                                                    needauth();
                                                }
                                            });
                                        }
                                    }
                                });
                            }
                        });
                    }
                });
            });
        }
    });
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhwb3J0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZXhwb3J0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQWEsUUFBQSxNQUFNLEdBQUMsQ0FBQyxPQUFjLEVBQUMsT0FBaUIsRUFBQyxRQUFrQixFQUFDLE9BQWlCLEVBQVEsRUFBRTtJQUNsRyxNQUFNLE9BQU8sR0FBRyxDQUFDLE9BQXdDLEVBQUUsR0FBVyxFQUFFLE9BQWlCLEVBQVEsRUFBRTtRQUNqRyxJQUFJLENBQUMsR0FBRyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUE7UUFDbEIsSUFBSSxDQUFDLEdBQUcsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFBO1FBQ2xCLElBQUksS0FBSyxHQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQTtRQUN0QixJQUFJLE1BQU0sR0FBRyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUE7UUFFdkIsT0FBTyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUE7SUFHN0MsQ0FBQyxDQUFBO0lBQ0QsTUFBTSxRQUFRLEdBQUcsQ0FBQyxPQUF3QyxFQUFFLElBQVksRUFBRSxPQUFpQixFQUFRLEVBQUU7UUFDbkcsSUFBSSxDQUFDLEdBQUcsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFBO1FBQ2xCLElBQUksQ0FBQyxHQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQTtRQUNsQixJQUFJLEtBQUssR0FBRyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUE7UUFDdEIsT0FBTyxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsQ0FBQTtRQUN2QixPQUFPLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFBO0lBQ3JDLENBQUMsQ0FBQTtJQUNELE1BQU0sT0FBTyxHQUFHLENBQUMsT0FBd0MsRUFBRSxTQUFpQixFQUFRLEVBQUU7UUFDcEYs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Q0FBQztLQUNGLENBQUMsQ0FBQTtBQUNKLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBFeHBvcnQ9KGJvdHRsZXM6IGFueVtdLHN1Y2Nlc3M6IEZ1bmN0aW9uLG5lZWRhdXRoOiBGdW5jdGlvbixnZXRhdXRoOiBGdW5jdGlvbik6IHZvaWQgPT57XHJcbiAgY29uc3QgZHJhd1BpYyA9IChjb250ZXh0OiBXZWNoYXRNaW5pcHJvZ3JhbS5DYW52YXNDb250ZXh0LCB1cmw6IHN0cmluZywgcXVhbGl0eTogbnVtYmVyW10pOiB2b2lkID0+e1xyXG4gICAgbGV0IHggPSBxdWFsaXR5WzBdXHJcbiAgICBsZXQgeSA9IHF1YWxpdHlbMV1cclxuICAgIGxldCB3aWR0aCA9IHF1YWxpdHlbMl1cclxuICAgIGxldCBoZWlnaHQgPSBxdWFsaXR5WzNdXHJcblxyXG4gICAgY29udGV4dC5kcmF3SW1hZ2UodXJsLCB4LCB5LCB3aWR0aCwgaGVpZ2h0KVxyXG4gICAgLy9jb250ZXh0LmRyYXcodHJ1ZSlcclxuXHJcbiAgfVxyXG4gIGNvbnN0IGRyYXdUZXh0ID0gKGNvbnRleHQ6IFdlY2hhdE1pbmlwcm9ncmFtLkNhbnZhc0NvbnRleHQsIHRleHQ6IHN0cmluZywgcXVhbGl0eTogbnVtYmVyW10pOiB2b2lkID0+e1xyXG4gICAgbGV0IHggPSBxdWFsaXR5WzBdXHJcbiAgICBsZXQgeSA9IHF1YWxpdHlbMV1cclxuICAgIGxldCB3aWR0aCA9IHF1YWxpdHlbMl1cclxuICAgIGNvbnRleHQuc2V0Rm9udFNpemUoMzApXHJcbiAgICBjb250ZXh0LmZpbGxUZXh0KHRleHQsIHgsIHksIHdpZHRoKVxyXG4gIH1cclxuICBjb25zdCBkcmF3QWxsID0gKGNvbnRleHQ6IFdlY2hhdE1pbmlwcm9ncmFtLkNhbnZhc0NvbnRleHQsIGJvdHRsZVVybDogc3RyaW5nKTogdm9pZCA9PntcclxuICAgIGNvbnN0IGJvdHRsZUhlaWdodCA9IDMwMFxyXG4gICAgY29uc3QgYm90dGxlV2lkdGggPSAyMDBcclxuICAgIGNvbnN0IHRpdGxlSGVpZ2h0ID0gMTAwXHJcbiAgICBjb25zdCBwaWNXaWR0aCA9IDEwMFxyXG5cclxuICAgIC8v55S76IOM5pmvXHJcbiAgICBjb250ZXh0LnJlY3QoMCwgMCwgMTMwMCwgNDAwMClcclxuICAgIGNvbnRleHQuc2V0RmlsbFN0eWxlKFwid2hpdGVcIilcclxuICAgIGNvbnRleHQuZmlsbCgpXHJcbiAgICAvL2NvbnRleHQuZHJhdygpXHJcbiAgICBjb250ZXh0LnNldEZpbGxTdHlsZShcImJsYWNrXCIpXHJcbiAgICBcclxuICAgIGxldCBib3R0bGVJbmRleCA9IDBcclxuICAgIGZvcihsZXQgeSA9IDE7IHkgPD0gNjsgKyt5KXtcclxuICAgICAgZm9yIChsZXQgeCA9IDE7IHggPD0gNTsgKyt4KSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gYm90dGxlc1tib3R0bGVJbmRleF0uZnVsbDsgKytpKXtcclxuICAgICAgICAgIHN3aXRjaChpKXtcclxuICAgICAgICAgICAgY2FzZSAxOntcclxuICAgICAgICAgICAgICBkcmF3UGljKGNvbnRleHQsIGJvdHRsZXNbYm90dGxlSW5kZXhdLnBhdGgsIFs1MCAqIHggKyBib3R0bGVXaWR0aCAqICh4IC0gMSkgKyA4NSwgKGJvdHRsZUhlaWdodCArIDEwMCkgKiAoeSAtIDEpICsgdGl0bGVIZWlnaHQgKyAxOTUsIHBpY1dpZHRoLCBwaWNXaWR0aF0pXHJcbiAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXNlIDI6e1xyXG4gICAgICAgICAgICAgIGRyYXdQaWMoY29udGV4dCwgYm90dGxlc1tib3R0bGVJbmRleF0ucGF0aCwgWzUwICogeCArIGJvdHRsZVdpZHRoICogKHggLSAxKSArIDUsIChib3R0bGVIZWlnaHQgKyAxMDApICogKHkgLSAxKSArIHRpdGxlSGVpZ2h0ICsgMTUwLCBwaWNXaWR0aCwgcGljV2lkdGhdKVxyXG4gICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FzZSAzOntcclxuICAgICAgICAgICAgICBkcmF3UGljKGNvbnRleHQsIGJvdHRsZXNbYm90dGxlSW5kZXhdLnBhdGgsIFs1MCAqIHggKyBib3R0bGVXaWR0aCAqICh4IC0gMSkgKyA4NSwgKGJvdHRsZUhlaWdodCArIDEwMCkgKiAoeSAtIDEpICsgdGl0bGVIZWlnaHQgKyA5NSwgcGljV2lkdGgsIHBpY1dpZHRoXSlcclxuICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhc2UgNDp7XHJcbiAgICAgICAgICAgICAgZHJhd1BpYyhjb250ZXh0LCBib3R0bGVzW2JvdHRsZUluZGV4XS5wYXRoLCBbNTAgKiB4ICsgYm90dGxlV2lkdGggKiAoeCAtIDEpICsgNSwgKGJvdHRsZUhlaWdodCArIDEwMCkgKiAoeSAtIDEpICsgdGl0bGVIZWlnaHQgKyA1MCwgcGljV2lkdGgsIHBpY1dpZHRoXSlcclxuICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhc2UgNToge1xyXG4gICAgICAgICAgICAgIGRyYXdQaWMoY29udGV4dCwgYm90dGxlc1tib3R0bGVJbmRleF0ucGF0aCwgWzUwICogeCArIGJvdHRsZVdpZHRoICogKHggLSAxKSArIDg1LCAoYm90dGxlSGVpZ2h0ICsgMTAwKSAqICh5IC0gMSkgKyB0aXRsZUhlaWdodC01LCBwaWNXaWR0aCwgcGljV2lkdGhdKVxyXG4gICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy/nlLvnk7blrZBcclxuICAgICAgICBkcmF3UGljKGNvbnRleHQsIGJvdHRsZVVybCwgWzUwICogeCArIGJvdHRsZVdpZHRoICogKHggLSAxKSwgKGJvdHRsZUhlaWdodCArIDEwMCkgKiAoeSAtIDEpICsgdGl0bGVIZWlnaHQsIGJvdHRsZVdpZHRoLCBib3R0bGVIZWlnaHRdKVxyXG4gICAgICAgIGRyYXdUZXh0KGNvbnRleHQsIGJvdHRsZXNbYm90dGxlSW5kZXhdLm5hbWUsIFs1MCp4K2JvdHRsZVdpZHRoKih4LTEpKzQwLCAoYm90dGxlSGVpZ2h0KzUwKSp5KzUwKih5LTEpK3RpdGxlSGVpZ2h0LCAxNTBdKVxyXG4gICAgICAgIGJvdHRsZUluZGV4KytcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY29uc3QgY29udGV4dCA9IHd4LmNyZWF0ZUNhbnZhc0NvbnRleHQoJ2JvdHRsZUltZycpXHJcbiAgY29uc3QgYm90dGxlVXJsID0gXCJjbG91ZDovL2R4enNib3R0bGUtaXU4Y3guNjQ3OC1keHpzYm90dGxlLWl1OGN4LTEzMDEzMjczMTUvYm90dGxlLnBuZ1wiXHJcblxyXG4gIHd4LmNsb3VkLmRvd25sb2FkRmlsZSh7XHJcbiAgICBmaWxlSUQ6IGJvdHRsZVVybCxcclxuICAgIHN1Y2Nlc3M6IHJlcyA9PntcclxuICAgICAgZHJhd0FsbChjb250ZXh0LCByZXMudGVtcEZpbGVQYXRoKVxyXG5cclxuICAgICAgY29udGV4dC5kcmF3KHRydWUsIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgd3guY2FudmFzVG9UZW1wRmlsZVBhdGgoe1xyXG4gICAgICAgICAgY2FudmFzSWQ6IFwiYm90dGxlSW1nXCIsXHJcbiAgICAgICAgICBxdWFsaXR5OiAxLFxyXG4gICAgICAgICAgZGVzdFdpZHRoOiAxMzAwLFxyXG4gICAgICAgICAgZGVzdEhlaWdodDogNDAwMCxcclxuICAgICAgICAgIHN1Y2Nlc3MocmVzKSB7XHJcbiAgICAgICAgICAgIHd4LnNhdmVJbWFnZVRvUGhvdG9zQWxidW0oe1xyXG4gICAgICAgICAgICAgIGZpbGVQYXRoOiByZXMudGVtcEZpbGVQYXRoLFxyXG4gICAgICAgICAgICAgIHN1Y2Nlc3MoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIuaIkOWKn+S/neWtmFwiKVxyXG4gICAgICAgICAgICAgICAgc3VjY2VzcygpXHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICBmYWlsKHJlcykge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzLmVyck1zZylcclxuICAgICAgICAgICAgICAgIHd4LmdldFNldHRpbmcoe1xyXG4gICAgICAgICAgICAgICAgICBzdWNjZXNzKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghcmVzLmF1dGhTZXR0aW5nWydzY29wZS53cml0ZVBob3Rvc0FsYnVtJ10pIHtcclxuICAgICAgICAgICAgICAgICAgICAgIG5lZWRhdXRoKClcclxuICAgICAgICAgICAgICAgICAgICAgIHd4LmF1dGhvcml6ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlOiAnc2NvcGUud3JpdGVQaG90b3NBbGJ1bScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGdldGF1dGgoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWlsICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiQXV0aG9yaXphdGlvbiBGYWlsZWRcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBuZWVkYXV0aCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICB9KVxyXG5cclxuXHJcbiAgICB9XHJcbiAgfSlcclxufSJdfQ==